module proof2 where

open import proof public

-- Corrolary 1.1.1 (FP for closed terms).

fpc : âˆ€ {Î“ : Î“[ á´¢ ]} {Ã¸ : Î³[ á´¢ ]} {e : Term á´¢} {Ï„ : Ï„ á´¢} {â„¾ Î£â‚€} â†’ â„¾ âŠ¢ Ã¸ â†’ â„¾ âŠ¢ Ã¸ â†’ Î“ , Î£â‚€ âŠ¢ e â¦‚ Ï„ , zero â†’ âŸ¨ Ã¸ , Ã¸ âŸ©âˆˆğ’¢âŸ¦ zero Ë â„¾ âŸ§ â†’ âŸ¨ Ã¸ âŠ¢ e , Ã¸ âŠ¢ e âŸ©âˆˆâ„°âŸ¦ zero Ë (zero âŸ¨âŸ¨ Ï„ âŸ©âŸ©) âŸ§
fpc a b eâ‚ eâ‚‚ = fp a b eâ‚ eâ‚‚

âˆ£_-_âˆ£á´º : â„• â†’ â„• â†’ â„•
âˆ£ á´¢ - á´¢ âˆ£á´º = á´¢
âˆ£ á´¢ - êœ± n âˆ£á´º = êœ± n
âˆ£ êœ± m - á´¢ âˆ£á´º = êœ± m
âˆ£ êœ± m - êœ± n âˆ£á´º = âˆ£ m - n âˆ£á´º

âˆ£_-_|á´ºâ‰¤_ : â„• â†’ â„• â†’ Sens â†’ Set
âˆ£ nâ‚ - nâ‚‚ |á´ºâ‰¤ s = âŸ¨ âˆ£ nâ‚ - nâ‚‚ âˆ£á´º âŸ© â‰¤ s

-- -- Theorem 1.2 (Sensitivity Type Soundness at Base Types).

sound : âˆ€ {Î“ : Î“[ á´¢ ]} {Ã¸ : Î³[ á´¢ ]} {e s sâ€² râ‚ râ‚‚ râ€²â‚ râ€²â‚‚ â„¾ Î£â‚€ sb}
  â†’ â„¾ âŠ¢ Ã¸ â†’ â„¾ âŠ¢ Ã¸ â†’ âŸ¨ Ã¸ , Ã¸ âŸ©âˆˆğ’¢âŸ¦ zero Ë â„¾ âŸ§
  â†’ Î“ , Î£â‚€ âŠ¢ e â¦‚ (sÆ›â¦‚ â„T âˆ¥ sb â‡’[ zero âˆ” [ s ] ] â„T) , zero
  â†’ âˆ£ râ‚ - râ‚‚ |á´ºâ‰¤ sâ€²
  â†’ Ã¸ âŠ¢ e `app (`â„ râ‚) â‡“ ğ“‡ râ€²â‚
  â†’ Ã¸ âŠ¢ e `app (`â„ râ‚‚) â‡“ ğ“‡ râ€²â‚‚
  â†’ âˆ£ râ€²â‚ - râ€²â‚‚ |á´ºâ‰¤ (s Ã— sâ€²)
sound {râ€²â‚ = râ€²â‚} {râ€²â‚‚} âŠ¢Ã¸â‚ âŠ¢Ã¸â‚‚ r[âŠ¢Ã¸â‚,âŠ¢Ã¸â‚‚] âŠ¢e Îµ (âŠ¢`app {Î³ = Î³â‚} {eâ€² = eâ€²â‚} Î´â‚ Î´â‚‚ Î´â‚ƒ) (âŠ¢`app {Î³ = Î³â‚‚} {eâ€² = eâ€²â‚‚} Î´â‚„ Î´â‚… Î´â‚†)
  = fp âŠ¢Ã¸â‚ âŠ¢Ã¸â‚‚ âŠ¢e r[âŠ¢Ã¸â‚,âŠ¢Ã¸â‚‚] (sÆ›â¦‚ eâ€²â‚ âˆ¥ Î³â‚ ) (sÆ›â¦‚ eâ€²â‚‚ âˆ¥ Î³â‚‚ ) (typeSafety âŠ¢e Î´â‚) (typeSafety âŠ¢e Î´â‚„) âŸ¨ Î´â‚ , Î´â‚„ âŸ©
